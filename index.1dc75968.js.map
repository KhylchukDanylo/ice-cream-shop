{"mappings":"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","sources":["src/js/videotube.js"],"sourcesContent":["(() => {\n\tconst throttle = (type, name, obj) => {\n\t\tobj = obj || window;\n\t\tlet running = false;\n\t\tconst func = function() {\n\t\t\tif (running) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trunning = true;\n\t\t\trequestAnimationFrame(function() {\n\t\t\t\tobj.dispatchEvent(new CustomEvent(name));\n\t\t\t\trunning = false;\n\t\t\t});\n\t\t};\n\t\tobj.addEventListener(type, func);\n\t};\n\n\tthrottle(\"resize\", \"optimizedResize\");\n})();\n\n((obj) => {\n\tobj = obj || window;\n\tobj.animation = function(elem, prop, cb) {\n\t\tconst count = prop.count;\n\t\tlet counter = 0\n\t\tif (prop.start) {\n\t\t\tprop.start.forEach(item => {\n\t\t\t\telem.style[item[0]] = item[1]\n\t\t\t})\n\t\t}\n\n\t\tconst allAnimation = [];\n\n\t\tprop.anim.forEach(([style, from, to]) => {\n\t\t\tconst max = Math.max(from, to);\n\t\t\tconst min = Math.min(from, to);\n\t\t\tconst step = (max - min) / count;\n\t\t\tallAnimation.push({style, from, to, step, reverse: min === to})\n\t\t});\n\n\n\t\tconst rafAnimation = () => {\n\n\t\t\tallAnimation.forEach((item) => {\n\t\t\t\tif (item.reverse) {\n\t\t\t\t\titem.from -= item.step\n\t\t\t\t} else {\n\t\t\t\t\titem.from += item.step\n\t\t\t\t}\n\n\t\t\t\telem.style[item.style] = item.from;\n\t\t\t})\n\n\t\t\tcounter++;\n\t\t\tif (counter < count) {\n\n\t\t\t\trequestAnimationFrame(rafAnimation);\n\t\t\t} else {\n\t\t\t\tif (prop.end) {\n\t\t\t\t\tprop.end.forEach(item => {\n\t\t\t\t\t\telem.style[item[0]] = item[1]\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (cb) cb();\n\t\t\t}\n\n\n\t\t}\n\t\trequestAnimationFrame(rafAnimation);\n\t};\n})();\n\n\nconst init = () => {\n\n\tconst overlay = document.createElement('div');\n\toverlay.className = 'videotube-modal-overlay'\n\tdocument.body.insertAdjacentElement('beforeend', overlay);\n\n\tconst video = document.createElement('div');\n\tvideo.id = 'videotube-modal-container'\n\n\tconst sizeBlockList = [\n\t\t[3840, 2160],\n\t\t[2560, 1440],\n\t\t[1920, 1080],\n\t\t[1280, 720],\n\t\t[854, 420],\n\t\t[640, 360],\n\t\t[426, 240]\n\t];\n\n\n\tconst sizeVideo = () => {\n\t\tconst sizeBlock = sizeBlockList.find(item => item[0] < window.visualViewport.width) ||\n\t\t\tsizeBlockList[sizeBlockList.length - 1];\n\n\t\tconst iframe = document.getElementById('videotube-modal');\n\t\tiframe.width = sizeBlock[0];\n\t\tiframe.height = sizeBlock[1];\n\t\tvideo.style.cssText = `\n\t\t\twidth: ${sizeBlock[0]};\n\t\t\theight: ${sizeBlock[1]};\n\t\t`;\n\n\t}\n\n\tconst sizeContainer = () => {\n\n\t\tconst wh = window.visualViewport.height;\n\t\tconst ww = window.visualViewport.width;\n\t\tconst fw = video.style.width;\n\t\tconst fh = video.style.height;\n\n\t\tvideo.style.left = (ww - fw) / 2;\n\t\tvideo.style.top = (wh - fh) / 2;\n\t\toverlay.style.height = document.documentElement.clientHeight;\n\t}\n\n\tconst sizeVideoTubeModal = () => {\n\t\tsizeContainer();\n\t\tsizeVideo();\n\t}\n\n\tconst closeVideoTubeModal = () => {\n\n\t\tanimation(overlay, {\n\t\t\t\tend: [['display', 'none']],\n\t\t\t\tanim: [['opacity', 1, 0]],\n\t\t\t\tcount: 20,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\toverlay.textContent = \"\";\n\t\t\t}\n\t\t);\n\t\twindow.removeEventListener(\"optimizedResize\", sizeVideoTubeModal);\n\t\tdocument.removeEventListener('keyup', closeContainerEsc);\n\t}\n\n\tconst closeContainerEsc = e => {\n\t\tif (e.keyCode === 27) {\n\t\t\tcloseVideoTubeModal();\n\t\t}\n\t}\n\n\n\tconst openVideoTubeModal = e => {\n\t\t\tconst target = e.target.closest('.tube');\n\t\t\tif (!target) return;\n\n\t\t\tconst href = target.href;\n\t\t\tconst search = href.includes('youtube');\n\t\t\tlet idVideo = search ? href.match(/(\\?|&)v=([^&]+)/)[2] : href.match(/(\\.be\\/)([^&]+)/)[2];\n\n\t\t\tif (idVideo.length === 0) return;\n\n\t\t\te.preventDefault();\n\n\t\t\tanimation(overlay, {\n\t\t\t\t\tstart: [['display', 'block']],\n\t\t\t\t\tanim: [['opacity', 0, 1]],\n\t\t\t\t\tcount: 20,\n\t\t\t\t}\n\t\t\t);\n\n\t\t\toverlay.insertAdjacentHTML('beforeend', `\n\t\t\t<div id=\"videotube-modal-loading\">Загрузка...</div>\n\t\t\t<div id=\"videotube-modal-close\">&#10006;</div>\n\t\t\t<div id=\"videotube-modal-container\">\n\t\t\t\t<iframe src=\"https://youtube.com/embed/${idVideo}?autoplay=1\" \n\t\t\t\t\tframeborder=\"0\"\n\t\t\t\t\tid=\"videotube-modal\" \n\t\t\t\t\tallowfullscreen\n\t\t\t\t\tallow=\"autoplay\">\n\t\t\t\t</iframe>\n\t\t\t</div>\n\t\t`)\n\n\t\t\tsizeVideo();\n\t\t\tsizeContainer();\n\n\t\t\twindow.addEventListener(\"optimizedResize\", sizeVideoTubeModal);\n\t\t\tdocument.addEventListener('keyup', closeContainerEsc);\n\t\t}\n\t;\n\n\n\toverlay.addEventListener(\"click\", closeVideoTubeModal);\n\tdocument.addEventListener('click', openVideoTubeModal)\n\n}\n\ndocument.addEventListener('DOMContentLoaded', init)\n"],"names":["_arrayLikeToArray","arr","len","type","name","obj","window","running","addEventListener","requestAnimationFrame","dispatchEvent","CustomEvent","throttle","animation","elem","prop","cb","count","counter","start","forEach","item","style","allAnimation","anim","param","_param","from","to","max","Math","min","step","push","reverse","rafAnimation","end","init","overlay","document","createElement","className","body","insertAdjacentElement","video","id","sizeBlockList","sizeVideo","sizeBlock","find","visualViewport","width","length","iframe","getElementById","height","cssText","concat","sizeContainer","wh","ww","fw","fh","left","top","documentElement","clientHeight","sizeVideoTubeModal","closeVideoTubeModal","textContent","removeEventListener","closeContainerEsc","e","keyCode","target","closest","href","idVideo","includes","match","preventDefault","insertAdjacentHTML"],"version":3,"file":"index.1dc75968.js.map"}